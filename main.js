(()=>{"use strict";function e(e){e=e.replaceAll(" ","").replaceAll("+"," + ").replaceAll("x"," * ").replaceAll("-"," - ").replaceAll("/"," / ").split(" ");for(let t=0;t<e.length;t++)""==e[t]&&(e.splice(t,2),e[t]="-"+e[t]);let t=document.createElement("calc");t.style.opacity=`calc(${e.join(" ")})`;let l=parseFloat(t.style.opacity.replace("calc(","").replace(")",""));return t.remove(),l}let t=["x","/","-","+","."],l="",n=[],o="",r=document.querySelector(".input"),u=document.querySelector(".story");function c(c){let i="string"==typeof c?c:c.currentTarget.getAttribute("inTo");if(!i)return!1;if("AC"===i){const e=function(e,t){return e.value="",t.innerHTML="",{input:"",longStory:""}}(r,u);return l=e.input,o=e.longStory,!1}if("="===i)return function(e,t,l,n,o,r){t!==e.value&&(t=e.value);let u=l?`(${l.split("=")[0]})${t.replace(l.split("=")[1],"")}`:t,c=r(u);return isNaN(c)?(e.value="Ошибка",!1):(l=`${u}=${c}`,o.push(`${t}=${c}`),n.innerHTML+=`<i>${o[o.length-1]}</i>`,t=e.value=c,!1)}(r,l,o,u,n,e);if("+/-"===i){const e=function(e,t){if(!t)return{input:"-",shouldUpdate:!0};const l=t[t.length-1];return["+","-","*","/"].includes(l)?{input:t+"-",shouldUpdate:!0}:t.startsWith("-")?{input:t.slice(1),shouldUpdate:!0}:{input:`-${t}`,shouldUpdate:!0}}(0,l);return e.shouldUpdate&&(l=e.input,r.value=l),!1}if("%"===i)return function(e,t){let l=t.lastIndexOf("-"),n=parseFloat(t.substring(0,l)),o=parseFloat(t.substring(l+1,t.length)),r=n-n*o/100;return isNaN(r)?(e.value="Ошибка",!1):(t=`${n} - ${o}%`,e.value=r,!1)}(r,l);(n.length&&"."===i||!l&&"."===i)&&(i="0."),t.includes(l[l.length-1])&&t.includes(i)&&("-"!==i&&t.includes(l[l.length-1])&&(l=l.slice(0,-1)),("-"===i&&"-"===l[l.length-1]||"-"===i&&"+"===l[l.length-1])&&(l=l.slice(0,-1)),"-"!==i&&t.includes(l[l.length-1])&&(l=l.slice(0,-1))),""===l&&t.includes(i)&&"-"!==i&&(i=""),n.length&&!t.includes(i)&&(l="",o=""),n=[],l+=i,r.value=l}[...document.querySelectorAll("button")].forEach(function(e){e.onclick=c}),function(e={}){const{rootElement:t=document.documentElement,toggleButtonSelector:l="#themeToggle",darkThemeClass:n="dark",darkTextColor:o="#000000",lightTextColor:r="#ffffff",darkBackgroundColor:u="#4bd2e4",lightBackgroundColor:c="#4f6579"}=e,i=document.querySelector(l);if(!i)return void console.warn(`Theme toggle button not found with selector: ${l}`);i.addEventListener("click",e=>{e.preventDefault();const l=t.classList.toggle(n);i.style.color=l?o:r,i.style.backgroundColor=l?u:c});const s=t.classList.contains(n);i.style.color=s?o:r,i.style.backgroundColor=s?u:c}(),e()})();